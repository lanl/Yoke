<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="yoke.utils.training package" href="yoke.utils.training.html" /><link rel="prev" title="yoke.models.vit.swin package" href="yoke.models.vit.swin.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>yoke.utils package - Get Yoked!</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=acfd86a5" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Get Yoked!</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">Get Yoked!</span>
  
</a><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="harnesses.html">Yoke Harnesses</a></li>
<li class="toctree-l1"><a class="reference internal" href="start_study.html">Using START_study.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="loderunner_animate.html">Lode Runner Animation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="prediction_modes.html">Prediction Modes Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="modules.html">yoke</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of yoke</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="yoke.html">yoke package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of yoke package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="yoke.datasets.html">yoke.datasets package</a></li>
<li class="toctree-l3"><a class="reference internal" href="yoke.helpers.html">yoke.helpers package</a></li>
<li class="toctree-l3"><a class="reference internal" href="yoke.losses.html">yoke.losses package</a></li>
<li class="toctree-l3"><a class="reference internal" href="yoke.metrics.html">yoke.metrics package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="yoke.models.html">yoke.models package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of yoke.models package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="yoke.models.vit.html">yoke.models.vit package</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of yoke.models.vit package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="yoke.models.vit.swin.html">yoke.models.vit.swin package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 current has-children current-page"><a class="current reference internal" href="#">yoke.utils package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of yoke.utils package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="yoke.utils.training.html">yoke.utils.training package</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of yoke.utils.training package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="yoke.utils.training.datastep.html">yoke.utils.training.datastep package</a></li>
<li class="toctree-l5"><a class="reference internal" href="yoke.utils.training.epoch.html">yoke.utils.training.epoch package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/yoke.utils.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="yoke-utils-package">
<h1>yoke.utils package<a class="headerlink" href="#yoke-utils-package" title="Link to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="yoke.utils.training.html">yoke.utils.training package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="yoke.utils.training.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="yoke.utils.training.datastep.html">yoke.utils.training.datastep package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.datastep.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.datastep.html#module-yoke.utils.training.datastep.array_output">yoke.utils.training.datastep.array_output module</a></li>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.datastep.html#module-yoke.utils.training.datastep.loderunner">yoke.utils.training.datastep.loderunner module</a></li>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.datastep.html#module-yoke.utils.training.datastep.lsc_policy">yoke.utils.training.datastep.lsc_policy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.datastep.html#module-yoke.utils.training.datastep.lsc_reward">yoke.utils.training.datastep.lsc_reward module</a></li>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.datastep.html#module-yoke.utils.training.datastep.scalar_output">yoke.utils.training.datastep.scalar_output module</a></li>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.datastep.html#module-yoke.utils.training.datastep">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="yoke.utils.training.epoch.html">yoke.utils.training.epoch package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.epoch.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.epoch.html#module-yoke.utils.training.epoch.array_output">yoke.utils.training.epoch.array_output module</a></li>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.epoch.html#module-yoke.utils.training.epoch.loderunner">yoke.utils.training.epoch.loderunner module</a></li>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.epoch.html#module-yoke.utils.training.epoch.lsc_policy">yoke.utils.training.epoch.lsc_policy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.epoch.html#module-yoke.utils.training.epoch.lsc_reward">yoke.utils.training.epoch.lsc_reward module</a></li>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.epoch.html#module-yoke.utils.training.epoch.scalar_output">yoke.utils.training.epoch.scalar_output module</a></li>
<li class="toctree-l4"><a class="reference internal" href="yoke.utils.training.epoch.html#module-yoke.utils.training.epoch">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="yoke.utils.training.html#module-yoke.utils.training">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-yoke.utils.checkpointing">
<span id="yoke-utils-checkpointing-module"></span><h2>yoke.utils.checkpointing module<a class="headerlink" href="#module-yoke.utils.checkpointing" title="Link to this heading">¶</a></h2>
<p>Functions for checkpointing models and optimizers in PyTorch.</p>
<p>The functions provided here offer checkpointing capabilities that have behavior specific
to the Yoke framework. They are designed to work seamlessly with the Yoke training and
evaluation processes, ensuring that model states can be saved and restored effectively.</p>
<dl class="py function">
<dt class="sig sig-object py" id="yoke.utils.checkpointing.load_model_and_optimizer">
<span class="sig-prename descclassname"><span class="pre">yoke.utils.checkpointing.</span></span><span class="sig-name descname"><span class="pre">load_model_and_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available_models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optimizer</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/yoke/utils/checkpointing.html#load_model_and_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yoke.utils.checkpointing.load_model_and_optimizer" title="Link to this definition">¶</a></dt>
<dd><p>Dynamically load model &amp; optimizer state from checkpoint.</p>
<p>NOTE: This function only works while loading checkpoints created by
<cite>save_model_and_optimizer</cite></p>
<ul class="simple">
<li><p>Working for both DDP and non-DDP training.</p></li>
<li><p>Loads the checkpoint only on rank 0 when in DDP.</p></li>
<li><p>If using DDP, broadcasts the checkpoint to all other ranks.</p></li>
<li><p>Handles models both inside and outside of <cite>DistributedDataParallel</cite>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – Checkpoint filename.</p></li>
<li><p><strong>optimizer_class</strong> (<em>type</em>) – Torch optimizer class</p></li>
<li><p><strong>optimizer_kwargs</strong> (<em>dict</em>) – Dictionary of optimizer parameters.</p></li>
<li><p><strong>available_models</strong> (<em>dict</em>) – Dictionary mapping class names to class references.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – String or device specifier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yoke.utils.checkpointing.load_model_and_optimizer_hdf5">
<span class="sig-prename descclassname"><span class="pre">yoke.utils.checkpointing.</span></span><span class="sig-name descname"><span class="pre">load_model_and_optimizer_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/yoke/utils/checkpointing.html#load_model_and_optimizer_hdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yoke.utils.checkpointing.load_model_and_optimizer_hdf5" title="Link to this definition">¶</a></dt>
<dd><p>Loads state of model and optimizer stored in an hdf5 format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Pytorch model to load state into.</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim.Optimizer</em>) – Pytorch optimizer to load state into.</p></li>
<li><p><strong>filepath</strong> (<em>str</em>) – Path to the hdf5 checkpoint file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Epoch associated with training</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>epoch (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yoke.utils.checkpointing.save_model_and_optimizer">
<span class="sig-prename descclassname"><span class="pre">yoke.utils.checkpointing.</span></span><span class="sig-name descname"><span class="pre">save_model_and_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/yoke/utils/checkpointing.html#save_model_and_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yoke.utils.checkpointing.save_model_and_optimizer" title="Link to this definition">¶</a></dt>
<dd><p>Class-aware torch checkpointing.</p>
<p>Saves model &amp; optimizer state along with model-class information using torch.save.
Works for both DDP and non-DDP training. Model’s saved in this way should not be
considered <em>deployable</em>. For deployment the model should be converted to ONNX format.</p>
<ul class="simple">
<li><p>Stores the model’s class name and initialization args.</p></li>
<li><p>Works for both DDP and non-DDP training.</p></li>
<li><p>If model is wrapped in DDP (<cite>model.module</cite> exists), saves
<cite>model.module.state_dict()</cite>.</p></li>
<li><p>If model is NOT using DDP, saves <cite>model.state_dict()</cite>.</p></li>
<li><p>Moves model and optimizer to CPU to avoid CUDA-specific issues.</p></li>
<li><p>Saves only on rank 0 when using DDP to prevent redundant writes.</p></li>
<li><p>If using DDP, synchronizes all processes after saving to ensure consistency.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Torch nn.Module instance or DDP version thereof.</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim</em>) – Torch optimizer instance</p></li>
<li><p><strong>epoch</strong> (<em>int</em>) – Epoch index being checkpointed.</p></li>
<li><p><strong>filepath</strong> (<em>str</em>) – Checkpoint filename.</p></li>
<li><p><strong>model_class</strong> (<em>torch.nn.Module class</em>) – Class of model being checkpointed.</p></li>
<li><p><strong>model_args</strong> (<em>dict</em>) – Dictionary of model parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yoke.utils.checkpointing.save_model_and_optimizer_hdf5">
<span class="sig-prename descclassname"><span class="pre">yoke.utils.checkpointing.</span></span><span class="sig-name descname"><span class="pre">save_model_and_optimizer_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compiled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/yoke/utils/checkpointing.html#save_model_and_optimizer_hdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yoke.utils.checkpointing.save_model_and_optimizer_hdf5" title="Link to this definition">¶</a></dt>
<dd><p>Saves the state of a model and optimizer in portable hdf5 format.</p>
<p>Model and optimizer should be moved to the CPU prior to using this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Pytorch model to save</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim.Optimizer</em>) – Pytorch optimizer to save</p></li>
<li><p><strong>epoch</strong> (<em>int</em>) – Epoch associated with training</p></li>
<li><p><strong>filepath</strong> (<em>str</em>) – Where to save</p></li>
<li><p><strong>compiled</strong> (<em>bool</em>) – Flag to extract original model if model being saved
was compiled.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-yoke.utils.dataload">
<span id="yoke-utils-dataload-module"></span><h2>yoke.utils.dataload module<a class="headerlink" href="#module-yoke.utils.dataload" title="Link to this heading">¶</a></h2>
<p>Utility functions for creating pytorch dataloaders.</p>
<dl class="py function">
<dt class="sig sig-object py" id="yoke.utils.dataload.make_dataloader">
<span class="sig-prename descclassname"><span class="pre">yoke.utils.dataload.</span></span><span class="sig-name descname"><span class="pre">make_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefetch_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataLoader</span></span></span><a class="reference internal" href="_modules/yoke/utils/dataload.html#make_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yoke.utils.dataload.make_dataloader" title="Link to this definition">¶</a></dt>
<dd><p>Function to create a dataloader from a dataset.</p>
<p>Each dataloader has batch_size*num_batches samples randomly selected
from the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>torch.utils.data.Dataset</em>) – dataset to sample from for data loader</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – batch size</p></li>
<li><p><strong>num_batches</strong> (<em>int</em>) – number of batches to include in data loader</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – Number of processes to load data in parallel</p></li>
<li><p><strong>prefetch_factor</strong> (<em>int</em>) – Specifies the number of batches each worker preloads</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pytorch dataloader</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dataloader (torch.utils.data.DataLoader)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yoke.utils.dataload.make_distributed_dataloader">
<span class="sig-prename descclassname"><span class="pre">yoke.utils.dataload.</span></span><span class="sig-name descname"><span class="pre">make_distributed_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataLoader</span></span></span><a class="reference internal" href="_modules/yoke/utils/dataload.html#make_distributed_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yoke.utils.dataload.make_distributed_dataloader" title="Link to this definition">¶</a></dt>
<dd><p>Creates a DataLoader with a DistributedSampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>torch.utils.data.Dataset</em>) – dataset to sample from for data loader</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – batch size</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em>) – Switch to shuffle dataset</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – Number of processes to load data in parallel</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – Rank of device for distribution</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – Number of DDP processes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pytorch dataloader</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dataloader (torch.utils.data.DataLoader)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-yoke.utils.parallel">
<span id="yoke-utils-parallel-module"></span><h2>yoke.utils.parallel module<a class="headerlink" href="#module-yoke.utils.parallel" title="Link to this heading">¶</a></h2>
<p>Yoke module to assist GPU-parallel training.</p>
<p>Some models within Yoke require specific modifications to PyTorch multi-GPU
training utilities.</p>
<dl class="py class">
<dt class="sig sig-object py" id="yoke.utils.parallel.LodeRunner_DataParallel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">yoke.utils.parallel.</span></span><span class="sig-name descname"><span class="pre">LodeRunner_DataParallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/yoke/utils/parallel.html#LodeRunner_DataParallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yoke.utils.parallel.LodeRunner_DataParallel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DataParallel</span></code></p>
<p>Handle unique GPU splitting of LodeRunner inputs.</p>
<p>Since LodeRunner’s <em>forward</em> method has multiple inputs consisting of
several different shapes, some of which include a batch dimension and some
of which do not, we must handle the splitting of data across multiple GPUs
explicitly.</p>
<dl class="py method">
<dt class="sig sig-object py" id="yoke.utils.parallel.LodeRunner_DataParallel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/yoke/utils/parallel.html#LodeRunner_DataParallel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yoke.utils.parallel.LodeRunner_DataParallel.forward" title="Link to this definition">¶</a></dt>
<dd><p>Handle explicit GPU splitting.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-yoke.utils.parameters">
<span id="yoke-utils-parameters-module"></span><h2>yoke.utils.parameters module<a class="headerlink" href="#module-yoke.utils.parameters" title="Link to this heading">¶</a></h2>
<p>Utilities for managing model parameters, their state, and configurations.</p>
<dl class="py function">
<dt class="sig sig-object py" id="yoke.utils.parameters.count_torch_params">
<span class="sig-prename descclassname"><span class="pre">yoke.utils.parameters.</span></span><span class="sig-name descname"><span class="pre">count_torch_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/yoke/utils/parameters.html#count_torch_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yoke.utils.parameters.count_torch_params" title="Link to this definition">¶</a></dt>
<dd><p>Count parameters in a pytorch model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>nn.Module</em>) – Model to count parameters for.</p></li>
<li><p><strong>trainable</strong> (<em>bool</em>) – If TRUE, count only trainable parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="yoke.utils.parameters.freeze_torch_params">
<span class="sig-prename descclassname"><span class="pre">yoke.utils.parameters.</span></span><span class="sig-name descname"><span class="pre">freeze_torch_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/yoke/utils/parameters.html#freeze_torch_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yoke.utils.parameters.freeze_torch_params" title="Link to this definition">¶</a></dt>
<dd><p>Freeze all parameters in a PyTorch model in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>nn.Module</em>) – model to freeze.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-yoke.utils.restart">
<span id="yoke-utils-restart-module"></span><h2>yoke.utils.restart module<a class="headerlink" href="#module-yoke.utils.restart" title="Link to this heading">¶</a></h2>
<p>Functions to restart the training process after checkpointing.</p>
<dl class="py function">
<dt class="sig sig-object py" id="yoke.utils.restart.continuation_setup">
<span class="sig-prename descclassname"><span class="pre">yoke.utils.restart.</span></span><span class="sig-name descname"><span class="pre">continuation_setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpointpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studyIDX</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submissionType</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'slurm'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/yoke/utils/restart.html#continuation_setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#yoke.utils.restart.continuation_setup" title="Link to this definition">¶</a></dt>
<dd><p>Modify template submission files for training restart.</p>
<p>Function to generate the training.input and training.slurm files for
continuation of model training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpointpath</strong> (<em>str</em>) – path to model checkpoint to load in model from</p></li>
<li><p><strong>studyIDX</strong> (<em>int</em>) – study ID to include in file name</p></li>
<li><p><strong>last_epoch</strong> (<em>int</em>) – numer of epochs completed at this checkpoint</p></li>
<li><p><strong>submissionType</strong> (<em>str</em>) – Type of job-submission system to prepare files for.
Default ‘slurm’, either ‘slurm’, ‘flux’, ‘shell’,
or ‘batch’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Name of job-submission file defining job for</dt><dd><p>continued training</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>new_training_filepath (str)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-yoke.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-yoke.utils" title="Link to this heading">¶</a></h2>
<p>Utilities for training, checkpointing, manipulating models.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="yoke.utils.training.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">yoke.utils.training package</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="yoke.models.vit.swin.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">yoke.models.vit.swin package</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Los Alamos National Labs. Produced by: Kyle Hickmann, Skylar Callis, Gal Egozi, Soumi De, Bryan Kaiser, Sourabh Pandit, Sharmistha Chakrabarti, Derek Armstrong, Andrew Henrick, David Schodt
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">yoke.utils package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-yoke.utils.checkpointing">yoke.utils.checkpointing module</a><ul>
<li><a class="reference internal" href="#yoke.utils.checkpointing.load_model_and_optimizer"><code class="docutils literal notranslate"><span class="pre">load_model_and_optimizer()</span></code></a></li>
<li><a class="reference internal" href="#yoke.utils.checkpointing.load_model_and_optimizer_hdf5"><code class="docutils literal notranslate"><span class="pre">load_model_and_optimizer_hdf5()</span></code></a></li>
<li><a class="reference internal" href="#yoke.utils.checkpointing.save_model_and_optimizer"><code class="docutils literal notranslate"><span class="pre">save_model_and_optimizer()</span></code></a></li>
<li><a class="reference internal" href="#yoke.utils.checkpointing.save_model_and_optimizer_hdf5"><code class="docutils literal notranslate"><span class="pre">save_model_and_optimizer_hdf5()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-yoke.utils.dataload">yoke.utils.dataload module</a><ul>
<li><a class="reference internal" href="#yoke.utils.dataload.make_dataloader"><code class="docutils literal notranslate"><span class="pre">make_dataloader()</span></code></a></li>
<li><a class="reference internal" href="#yoke.utils.dataload.make_distributed_dataloader"><code class="docutils literal notranslate"><span class="pre">make_distributed_dataloader()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-yoke.utils.parallel">yoke.utils.parallel module</a><ul>
<li><a class="reference internal" href="#yoke.utils.parallel.LodeRunner_DataParallel"><code class="docutils literal notranslate"><span class="pre">LodeRunner_DataParallel</span></code></a><ul>
<li><a class="reference internal" href="#yoke.utils.parallel.LodeRunner_DataParallel.forward"><code class="docutils literal notranslate"><span class="pre">LodeRunner_DataParallel.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-yoke.utils.parameters">yoke.utils.parameters module</a><ul>
<li><a class="reference internal" href="#yoke.utils.parameters.count_torch_params"><code class="docutils literal notranslate"><span class="pre">count_torch_params()</span></code></a></li>
<li><a class="reference internal" href="#yoke.utils.parameters.freeze_torch_params"><code class="docutils literal notranslate"><span class="pre">freeze_torch_params()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-yoke.utils.restart">yoke.utils.restart module</a><ul>
<li><a class="reference internal" href="#yoke.utils.restart.continuation_setup"><code class="docutils literal notranslate"><span class="pre">continuation_setup()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-yoke.utils">Module contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=8a448e45"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>